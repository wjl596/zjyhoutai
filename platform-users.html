<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="renderer" content="webkit">
<meta name="csrf-param" content="_csrf-backend">
<meta name="csrf-token" content="Q2ZTMmtJa3I2IB4LGRMZBxMOB3ADPyIUMSICXFMBMwcVM2FdMwpdOw==">
<title>筑家易后台管理系统</title>
<meta name="keywords" content="筑家易后台管理系统">
<meta name="description" content="筑家易后台管理系统">
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/font-awesome.min.css" rel="stylesheet">
<link href="css/plugins/iCheck/custom.css" rel="stylesheet">
<link href="css/animate.min.css" rel="stylesheet">
<link href="css/style.min.css" rel="stylesheet">
<link href="css/plugins/sweetalert/sweetalert.css" rel="stylesheet">
<!-- 全局js -->
<script src="js/jquery-2.1.1.min.js"></script>
<script src="js/bootstrap.min.js?v=3.4.0"></script>
<script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>
<script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
<script src="js/plugins/layer/layer.min.js"></script>
<script src="js/plugins/sweetalert/sweetalert.min.js"></script>
<!-- 自定义js -->

<!-- 第三方插件 -->
<script src="js/plugins/pace/pace.min.js"></script>
</head>
<body>
<style>
    .layui-layer-btn a {
        margin-top:8px!important;
    }
    .control-label{padding-top: 7px;}
    #show-selected {
        margin-left: 5px!important;
    }
    .form-horizontal .form-group{
        margin-right: 0px!important;
        margin-left: 0px!important;
    }
</style>
<link href="css/rbac.css" rel="stylesheet">
<form id="search-form" class="form-horizontal" action="/index.php" method="get">
    <input type="hidden" name="r" value="manage/platform-users">
    <div class="form-group">
        <label class="col-sm-1 control-label">角色</label>
        <div class="col-sm-3" style="padding:0;">
            <select class="form-control" name="role_id" id="role_id">
                <option value="">请选择角色</option>
                <option value="11">测试角色</option>
                <option value="21">客户运营</option>
                <option value="31">客服角色</option>
                <option value="41">销售</option>
            </select>
        </div>
        <label class="col-sm-1 control-label">员工</label>
        <div class="col-sm-4" style="padding:0;">
            <input type="text" id="keyword" value="" name="keyword" placeholder="请输入姓名、手机号码" class="form-control">
        </div>
        <div class="col-sm-3">
            <input type="hidden" id="depart_id" name="depart_id" value=""/>
            <a class="layui-layer-btn0" class="btn btn-primary" href="javascript:void(0);" id="search_btn">
            <button class="btn btn-primary" type="button">搜索</button>
            </a>
            <a class="layui-layer-btn1" class="btn btn-primary" href="javascript:void(0);" id="reset_btn">
            <button class="btn btn-primary" type="button">重置</button>
            </a>
        </div>
    </div>
    <div class="form-group" id="show-selected" style="display: none;">
        <h3 class="font-bold" id="selected_num" style="padding-left: 12px;">已选3项</h3>
        <p>
            <button type="button" data_button_id="61" onclick="editUser(61)" class="btn btn-outline btn-link">编辑</button>
            <button type="button" data_button_id="62" onclick ="editRole(62)" class="btn btn-outline btn-link">设置角色和职能</button>
            <button type="button" data_button_id="64" class="btn btn-outline btn-link" onclick="editState('forbidden',64)">禁用</button>
            <button type="button" data_button_id="63" class="btn btn-outline btn-link" onclick="editState('enabled',63)">启用</button>
        </p>
    </div>
    <div id="user_table" class="grid-view">
        <table class="table table-striped table-bordered table-hover dataTables-example dataTable">
        <thead>
        <tr class="tb-title">
            <th width="5%">
                <input type="checkbox" class="select-on-check-all" name="selection_all" value="1">
            </th>
            <th>
                姓名
            </th>
            <th>
                电话
            </th>
            <th>
                性别
            </th>
            <th>
                角色
            </th>
            <th>
                职能
            </th>
            <th>
                直属上级
            </th>
            <th>
                状态
            </th>
            <th width="15%">
                入职时间
            </th>
            <th width="15%">
                创建时间
            </th>
        </tr>
        </thead>
        <tbody>
        <tr data-key="41">
            <td>
                <input type="checkbox" name="selection[]" value="41">
            </td>
            <td>
                夏
            </td>
            <td>
                18767122780
            </td>
            <td>
                男
            </td>
            <td>
                测试角色
            </td>
            <td>
                本人及下属
            </td>
            <td>
            </td>
            <td>
                启用
            </td>
            <td>
            </td>
            <td>
                2017-01-04
            </td>
        </tr>
        <tr data-key="31">
            <td>
                <input type="checkbox" name="selection[]" value="31">
            </td>
            <td>
                crazy
            </td>
            <td>
                18314867566
            </td>
            <td>
                女
            </td>
            <td>
                客服角色
            </td>
            <td>
                全部
            </td>
            <td>
            </td>
            <td>
                启用
            </td>
            <td>
                2016-12-21
            </td>
            <td>
                2016-12-21
            </td>
        </tr>
        <tr data-key="21">
            <td>
                <input type="checkbox" name="selection[]" value="21">
            </td>
            <td>
                冯文超
            </td>
            <td>
                15397041059
            </td>
            <td>
                女
            </td>
            <td>
                客服角色
            </td>
            <td>
                普通员工
            </td>
            <td>
            </td>
            <td>
                启用
            </td>
            <td>
                2016-09-20
            </td>
            <td>
                2016-12-20
            </td>
        </tr>
        <tr data-key="11">
            <td>
                <input type="checkbox" name="selection[]" value="11">
            </td>
            <td>
                菜菜
            </td>
            <td>
                15869126834
            </td>
            <td>
                男
            </td>
            <td>
                测试角色
            </td>
            <td>
                本人及下属
            </td>
            <td>
                夏
            </td>
            <td>
                启用
            </td>
            <td>
            </td>
            <td>
                2016-12-20
            </td>
        </tr>
        </tbody>
        </table>
    </div>
    <div class="row">
        <div class="col-sm-6">
            <div class="dataTables_info">
                显示 
                <b>1</b>到<b>4</b>项 ，共<b>4</b>项.
            </div>
        </div>
    </div>
</form>
<!-- 设置角色与职能 end-->
<script src="js/alert.js"></script>
<!-- Bootstrap-Treeview plugin javascript -->
<script src="js/bootstrap-treeview.js"></script>
<!-- 自定义js -->
<script src="js/content.min.js?v=1.0.0"></script>
<!-- Chosen -->
<script src="js/plugins/chosen/chosen.jquery.js"></script>
<!-- layerDate plugin javascript -->
<script src="js/plugins/layer/laydate/laydate.js"></script>
<script>
    var btnArr = ["20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72"];
    $("[data_button_id]").each(function () {
        var button_id = $(this).attr("data_button_id");
        var tmpKey    = $.inArray(button_id,btnArr);
        if( tmpKey < 0) {
            $(this).hide();
        }else{
            $(this).show();
        }
    });
    //搜索事件
    function formSearch()
    {
        $("#search-form").submit();
    }
    $("#search_btn").click(function () {
        $("#search-form").submit();
    });
    //重置事件
    $("#reset_btn").click(function () {
        $("#role_id").val("");
        $("#keyword").val("");
    });
    //gridview的选中事件
    $("input[name='selection[]'").on("click",function () {
        //判断是否还有选中项
        var is_sel = 0;
        $("input[name='selection[]']").each(function(){
            if(this.checked){
                is_sel++;
            }
        });
        if(is_sel>0){
            $("#show-selected").show();
            $("#selected_num").html("已选"+is_sel+"项");
        } else {
            $("#show-selected").hide();
        }
    });
    $("input[name='selection_all'").on("click",function () {
        var is_sel = 4;
        if(this.checked){
            $("#selected_num").html("已选"+is_sel+"项");
            $("#show-selected").show();
        }else{
            $("#show-selected").hide();
        }
    });
    //编辑用户
    function editUser(btnId) {
        var keys = $('#user_table').yiiGridView('getSelectedRows');
        window.parent.editUser(btnId,keys);
    }
    //设置角色和职能
    function editRole(btnId){
        var keys = $('#user_table').yiiGridView('getSelectedRows');
        window.parent.editRole(btnId,keys);
    }
    //修改状态
    function editState(state,btnId) {
        var keys      = $('#user_table').yiiGridView('getSelectedRows');
        window.parent.editState(state,btnId,keys);
    }
</script>
<script src="assets/8efc5733/yii.js"></script>
<script src="assets/8efc5733/yii.gridView.js"></script>
<script src="assets/8efc5733/yii.activeForm.js"></script>
<script type="text/javascript">jQuery(document).ready(function () {
jQuery('#user_table').yiiGridView({"filterUrl":"\/index.php?r=manage\/platform-users","filterSelector":"#user_table-filters input, #user_table-filters select"});
jQuery('#user_table').yiiGridView('setSelectionColumn', {"name":"selection[]","multiple":true,"checkAll":"selection_all"});
jQuery('#search-form').yiiActiveForm([], []);
});</script>
</body>
</html>